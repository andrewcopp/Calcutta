SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2024)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2024', 7, '2024-03-21T11:15:00-05:00',
  NULLIF('East', ''), NULLIF('West', ''), NULLIF('South', ''), NULLIF('Midwest', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2024
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('akron', 14, 'Midwest', 1, 0, true),
  ('alabama', 4, 'West', 1, 4, true),
  ('arizona', 2, 'West', 1, 2, true),
  ('auburn', 4, 'East', 1, 0, true),
  ('baylor', 3, 'West', 1, 1, true),
  ('boise-state', 10, 'South', 0, 0, true),
  ('brigham-young', 6, 'East', 1, 0, true),
  ('clemson', 6, 'West', 1, 3, true),
  ('colgate', 14, 'West', 1, 0, true),
  ('college-of-charleston', 13, 'West', 1, 0, true),
  ('colorado', 10, 'South', 0, 2, true),
  ('colorado-state', 10, 'Midwest', 0, 1, true),
  ('connecticut', 1, 'East', 1, 6, false),
  ('creighton', 3, 'Midwest', 1, 2, true),
  ('dayton', 7, 'West', 1, 1, true),
  ('drake', 10, 'East', 1, 0, true),
  ('duke', 4, 'South', 1, 3, true),
  ('duquesne', 11, 'East', 1, 1, true),
  ('florida', 7, 'South', 1, 0, true),
  ('florida-atlantic', 8, 'East', 1, 0, true),
  ('gonzaga', 5, 'Midwest', 1, 2, true),
  ('grambling', 16, 'Midwest', 0, 1, true),
  ('grand-canyon', 12, 'West', 1, 1, true),
  ('houston', 1, 'South', 1, 2, true),
  ('howard', 16, 'West', 0, 0, true),
  ('illinois', 3, 'East', 1, 3, true),
  ('iowa-state', 2, 'East', 1, 2, true),
  ('james-madison', 12, 'South', 1, 1, true),
  ('kansas', 4, 'Midwest', 1, 1, true),
  ('kentucky', 3, 'South', 1, 0, true),
  ('long-beach-state', 15, 'West', 1, 0, true),
  ('longwood', 16, 'South', 1, 0, true),
  ('marquette', 2, 'South', 1, 2, true),
  ('mcneese-state', 12, 'Midwest', 1, 0, true),
  ('michigan-state', 9, 'West', 1, 1, true),
  ('mississippi-state', 8, 'West', 1, 0, true),
  ('montana-state', 16, 'Midwest', 0, 0, true),
  ('morehead-state', 14, 'East', 1, 0, true),
  ('nc-state', 11, 'South', 1, 4, true),
  ('nebraska', 8, 'South', 1, 0, true),
  ('nevada', 10, 'West', 1, 0, true),
  ('new-mexico', 11, 'West', 1, 0, true),
  ('north-carolina', 1, 'West', 1, 2, true),
  ('northwestern', 9, 'East', 1, 1, true),
  ('oakland', 14, 'South', 1, 1, true),
  ('oregon', 11, 'Midwest', 1, 1, true),
  ('purdue', 1, 'Midwest', 1, 5, true),
  ('saint-mary-s-ca', 5, 'West', 1, 0, true),
  ('saint-peter-s', 15, 'Midwest', 1, 0, true),
  ('samford', 13, 'Midwest', 1, 0, true),
  ('san-diego-state', 5, 'East', 1, 2, true),
  ('south-carolina', 6, 'Midwest', 1, 0, true),
  ('south-dakota-state', 15, 'East', 1, 0, true),
  ('stetson', 16, 'East', 1, 0, true),
  ('tcu', 9, 'Midwest', 1, 0, true),
  ('tennessee', 2, 'Midwest', 1, 3, true),
  ('texas', 7, 'Midwest', 1, 1, true),
  ('texas-a-m', 9, 'South', 1, 1, true),
  ('texas-tech', 6, 'South', 1, 0, true),
  ('uab', 12, 'East', 1, 0, true),
  ('utah-state', 8, 'Midwest', 1, 1, true),
  ('vermont', 13, 'South', 1, 0, true),
  ('virginia', 10, 'Midwest', 0, 0, true),
  ('wagner', 16, 'West', 0, 1, true),
  ('washington-state', 7, 'East', 1, 1, true),
  ('western-kentucky', 15, 'South', 1, 0, true),
  ('wisconsin', 5, 'South', 1, 0, true),
  ('yale', 13, 'East', 1, 1, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2024' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('akron', 4.93, 107, 102, 65.9),
  ('alabama', 22.48, 125.6, 103.1, 72.6),
  ('arizona', 26.62, 121.1, 94.5, 71.8),
  ('auburn', 28.9, 120.6, 91.7, 69.8),
  ('baylor', 22.3, 122.5, 100.2, 65.6),
  ('boise-state', 16.38, 114, 97.6, 66.8),
  ('brigham-young', 21.01, 120.5, 99.5, 69.1),
  ('clemson', 16.94, 117.4, 100.5, 66.1),
  ('colgate', 2.15, 104.7, 102.5, 66.2),
  ('college-of-charleston', 7.61, 113.7, 106.1, 69.8),
  ('colorado', 18.47, 117.6, 99.1, 67.5),
  ('colorado-state', 16.6, 115.4, 98.8, 65.8),
  ('connecticut', 32.21, 126.6, 94.4, 64.5),
  ('creighton', 23.4, 120.1, 96.7, 67),
  ('dayton', 17.3, 118.6, 101.3, 64.2),
  ('drake', 14.71, 115.6, 100.9, 67.8),
  ('duke', 24.88, 121.8, 97, 66.7),
  ('duquesne', 9.37, 106.9, 97.6, 66.3),
  ('florida', 18.19, 119.3, 101.1, 71.7),
  ('florida-atlantic', 16.23, 118.9, 102.7, 68.1),
  ('gonzaga', 21.56, 121, 99.4, 69.1),
  ('grambling', -7.81, 99.3, 107.1, 64.8),
  ('grand-canyon', 13.91, 113.5, 99.6, 68.1),
  ('houston', 31.72, 118.9, 87.2, 63.3),
  ('howard', -8.26, 105.5, 113.8, 67.5),
  ('illinois', 23.99, 125.6, 101.6, 69.9),
  ('iowa-state', 26.72, 113.9, 87.1, 67.3),
  ('james-madison', 12.9, 113.9, 101, 69.5),
  ('kansas', 19.23, 113.4, 94.2, 68.9),
  ('kentucky', 20.02, 122.7, 102.7, 72.7),
  ('long-beach-state', -0.02, 107.7, 107.8, 71.3),
  ('longwood', 0.96, 105.7, 104.8, 66.8),
  ('marquette', 22.74, 118.3, 95.6, 69),
  ('mcneese-state', 12.86, 114, 101.2, 65.6),
  ('michigan-state', 20.03, 113.8, 93.7, 65.2),
  ('mississippi-state', 17.98, 113.7, 95.7, 67.1),
  ('montana-state', -3.9, 103.3, 107.2, 68.8),
  ('morehead-state', 5.47, 109, 103.5, 64.2),
  ('nc-state', 13.06, 114.4, 101.3, 68.1),
  ('nebraska', 18.19, 115.9, 97.7, 68.6),
  ('nevada', 16.82, 115.6, 98.8, 66.6),
  ('new-mexico', 18.94, 115.4, 96.5, 72.7),
  ('north-carolina', 24.65, 117.8, 93.2, 70.4),
  ('northwestern', 15.91, 116.6, 100.7, 63.7),
  ('oakland', 2.82, 108.6, 105.8, 66.7),
  ('oregon', 13.43, 114, 100.6, 67.2),
  ('purdue', 29.12, 125, 95.9, 67.4),
  ('saint-mary-s-ca', 19.89, 114.9, 95, 61.9),
  ('saint-peter-s', -2.32, 98.6, 100.9, 64),
  ('samford', 9.79, 113.1, 103.3, 72.5),
  ('san-diego-state', 19.7, 113.5, 93.8, 66),
  ('south-carolina', 15.06, 114.7, 99.6, 62.9),
  ('south-dakota-state', 2.99, 108.7, 105.7, 67.9),
  ('stetson', -4.1, 110.3, 114.4, 66.2),
  ('tcu', 17.29, 115.1, 97.8, 69.7),
  ('tennessee', 25.97, 117, 91.1, 69.2),
  ('texas', 18.4, 118.5, 100.1, 67.2),
  ('texas-a-m', 16.11, 116, 99.9, 65.8),
  ('texas-tech', 18.54, 117.9, 99.4, 66.6),
  ('uab', 6.28, 113.7, 107.4, 67.8),
  ('utah-state', 15.11, 115.6, 100.5, 68.5),
  ('vermont', 6.98, 107.1, 100.1, 63.2),
  ('virginia', 12.07, 105.4, 93.3, 59.9),
  ('wagner', -10.09, 95.8, 105.9, 61.3),
  ('washington-state', 16.22, 113.4, 97.2, 64.8),
  ('western-kentucky', 3.06, 105.6, 102.5, 75.1),
  ('wisconsin', 20.6, 120.1, 99.5, 65.2),
  ('yale', 9.47, 110.8, 101.4, 64.5)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2024' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
