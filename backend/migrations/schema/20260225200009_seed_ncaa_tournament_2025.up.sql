SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2025)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2025', 7, '2025-03-20T11:00:00-05:00',
  NULLIF('South', ''), NULLIF('West', ''), NULLIF('East', ''), NULLIF('Midwest', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2025
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('akron', 13, 'East', 1, 0, true),
  ('alabama', 2, 'East', 1, 3, true),
  ('alabama-state', 16, 'South', 0, 1, true),
  ('american', 16, 'East', 0, 0, true),
  ('arizona', 4, 'East', 1, 2, true),
  ('arkansas', 10, 'West', 1, 2, true),
  ('auburn', 1, 'South', 1, 4, true),
  ('baylor', 9, 'East', 1, 1, true),
  ('brigham-young', 6, 'East', 1, 2, true),
  ('bryant', 15, 'South', 1, 0, true),
  ('clemson', 5, 'Midwest', 1, 0, true),
  ('colorado-state', 12, 'West', 1, 1, true),
  ('connecticut', 8, 'West', 1, 1, true),
  ('creighton', 9, 'South', 1, 1, true),
  ('drake', 11, 'West', 1, 1, true),
  ('duke', 1, 'East', 1, 4, true),
  ('florida', 1, 'West', 1, 6, false),
  ('georgia', 9, 'Midwest', 1, 0, true),
  ('gonzaga', 8, 'Midwest', 1, 1, true),
  ('grand-canyon', 13, 'West', 1, 0, true),
  ('high-point', 13, 'Midwest', 1, 0, true),
  ('houston', 1, 'Midwest', 1, 5, true),
  ('illinois', 6, 'Midwest', 1, 1, true),
  ('iowa-state', 3, 'South', 1, 1, true),
  ('kansas', 7, 'West', 1, 0, true),
  ('kentucky', 3, 'Midwest', 1, 2, true),
  ('liberty', 12, 'East', 1, 0, true),
  ('lipscomb', 14, 'South', 1, 0, true),
  ('louisville', 8, 'South', 1, 0, true),
  ('marquette', 7, 'South', 1, 0, true),
  ('maryland', 4, 'West', 1, 2, true),
  ('mcneese-state', 12, 'Midwest', 1, 1, true),
  ('memphis', 5, 'West', 1, 0, true),
  ('michigan', 5, 'South', 1, 2, true),
  ('michigan-state', 2, 'South', 1, 3, true),
  ('mississippi', 6, 'South', 1, 2, true),
  ('mississippi-state', 8, 'East', 1, 0, true),
  ('missouri', 6, 'West', 1, 0, true),
  ('montana', 14, 'East', 1, 0, true),
  ('mount-st-mary-s', 16, 'East', 0, 1, true),
  ('new-mexico', 10, 'South', 1, 1, true),
  ('norfolk-state', 16, 'West', 1, 0, true),
  ('north-carolina', 11, 'South', 0, 1, true),
  ('oklahoma', 9, 'West', 1, 0, true),
  ('omaha', 15, 'West', 1, 0, true),
  ('oregon', 5, 'East', 1, 1, true),
  ('purdue', 4, 'Midwest', 1, 2, true),
  ('robert-morris', 15, 'East', 1, 0, true),
  ('saint-francis-pa', 16, 'South', 0, 0, true),
  ('saint-mary-s-ca', 7, 'East', 1, 1, true),
  ('san-diego-state', 11, 'South', 0, 0, true),
  ('southern-illinois-edwardsville', 16, 'Midwest', 1, 0, true),
  ('st-john-s-ny', 2, 'West', 1, 1, true),
  ('tennessee', 2, 'Midwest', 1, 3, true),
  ('texas', 11, 'Midwest', 0, 0, true),
  ('texas-a-m', 4, 'South', 1, 1, true),
  ('texas-tech', 3, 'West', 1, 3, true),
  ('troy', 14, 'Midwest', 1, 0, true),
  ('uc-san-diego', 12, 'South', 1, 0, true),
  ('ucla', 7, 'Midwest', 1, 1, true),
  ('unc-wilmington', 14, 'West', 1, 0, true),
  ('utah-state', 10, 'Midwest', 1, 0, true),
  ('vanderbilt', 10, 'East', 1, 0, true),
  ('virginia-commonwealth', 11, 'East', 1, 0, true),
  ('wisconsin', 3, 'East', 1, 1, true),
  ('wofford', 15, 'Midwest', 1, 0, true),
  ('xavier', 11, 'Midwest', 0, 1, true),
  ('yale', 13, 'South', 1, 0, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2025' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('akron', 6.58, 113.7, 107.1, 71.4),
  ('alabama', 29.93, 126.5, 96.6, 74.9),
  ('alabama-state', -9.24, 101.4, 110.6, 67.7),
  ('american', -5.98, 102.1, 108, 63.5),
  ('arizona', 25.73, 122.5, 96.8, 69.9),
  ('arkansas', 17.71, 112.9, 95.2, 69.3),
  ('auburn', 35.05, 128.4, 93.4, 67.6),
  ('baylor', 21.15, 120.8, 99.7, 64.5),
  ('brigham-young', 22.39, 123, 100.6, 67.2),
  ('bryant', 1.25, 106.7, 105.5, 72.5),
  ('clemson', 23.92, 118.7, 94.7, 64.2),
  ('colorado-state', 17.29, 116.2, 98.9, 66),
  ('connecticut', 19.34, 121.9, 102.6, 63.7),
  ('creighton', 18.71, 116.9, 98.2, 67),
  ('drake', 14.14, 112.6, 98.5, 58.8),
  ('duke', 38.15, 128, 89.8, 65.7),
  ('florida', 36.16, 128.6, 92.4, 69.6),
  ('georgia', 19.39, 115.4, 96, 66.4),
  ('gonzaga', 27.29, 123.6, 96.3, 70.2),
  ('grand-canyon', 7.22, 107.8, 100.6, 71.4),
  ('high-point', 9.3, 118.5, 109.1, 66.4),
  ('houston', 35.44, 123.2, 87.8, 61.4),
  ('illinois', 23.56, 121.6, 98.1, 71.3),
  ('iowa-state', 27, 119.4, 92.4, 68.6),
  ('kansas', 23.26, 116, 92.7, 68.4),
  ('kentucky', 24.26, 123.8, 99.5, 70.9),
  ('liberty', 13.53, 112.5, 98.9, 65.3),
  ('lipscomb', 9.49, 112.7, 103.2, 65.9),
  ('louisville', 22.64, 118.1, 95.5, 68.7),
  ('marquette', 21.58, 117.7, 96.1, 67.6),
  ('maryland', 26.35, 118.1, 91.8, 69.8),
  ('mcneese-state', 13.69, 114.3, 100.6, 65.3),
  ('memphis', 15.35, 113.1, 97.8, 70.8),
  ('michigan', 22.28, 116, 93.7, 69.4),
  ('michigan-state', 27.57, 118.1, 90.6, 67.7),
  ('mississippi', 22.09, 117.8, 95.8, 68),
  ('mississippi-state', 20.11, 118.7, 98.6, 68.1),
  ('missouri', 24.42, 125.3, 100.9, 68.2),
  ('montana', 0.38, 110.8, 110.4, 67),
  ('mount-st-mary-s', -6.67, 100.1, 106.8, 67.4),
  ('new-mexico', 17.32, 112.5, 95.2, 72.7),
  ('norfolk-state', -1.53, 107.1, 108.7, 66.3),
  ('north-carolina', 19.55, 118.9, 99.3, 70.4),
  ('oklahoma', 18.36, 119, 100.7, 68.5),
  ('omaha', 0.51, 111, 110.5, 67.7),
  ('oregon', 20.15, 116.6, 96.5, 67.6),
  ('purdue', 23.84, 124.2, 100.4, 65),
  ('robert-morris', 2.09, 107, 104.9, 67.8),
  ('saint-francis-pa', -12.76, 99.7, 112.4, 66.9),
  ('saint-mary-s-ca', 23.09, 115.3, 92.2, 61.7),
  ('san-diego-state', 16.37, 109.8, 93.5, 66),
  ('southern-illinois-edwardsville', -4.32, 101.9, 106.2, 65.8),
  ('st-john-s-ny', 26.38, 113.9, 87.5, 70.1),
  ('tennessee', 31.15, 120.3, 89.1, 63.6),
  ('texas', 17.15, 116.7, 99.5, 67.4),
  ('texas-a-m', 24.08, 116.2, 92.1, 66.1),
  ('texas-tech', 28.05, 125.3, 97.2, 65.4),
  ('troy', 6.88, 107.7, 100.8, 66.3),
  ('uc-san-diego', 18.78, 115.2, 96.5, 65.7),
  ('ucla', 21.76, 116.8, 95.1, 64.9),
  ('unc-wilmington', 5.14, 112.3, 107.1, 65.3),
  ('utah-state', 15.22, 120.7, 105.5, 67.5),
  ('vanderbilt', 16.16, 117.9, 101.8, 69.4),
  ('virginia-commonwealth', 20.61, 116.3, 95.7, 66.1),
  ('wisconsin', 25.98, 122, 96, 67.6),
  ('wofford', 4.16, 113.6, 109.5, 64),
  ('xavier', 17.2, 115.5, 98.3, 69.1),
  ('yale', 11.04, 115.1, 104, 67.2)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2025' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
