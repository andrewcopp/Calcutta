SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2017)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2017', 7, '2017-03-16T11:15:00-05:00',
  NULLIF('East', ''), NULLIF('West', ''), NULLIF('Midwest', ''), NULLIF('South', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2017
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('arizona', 2, 'West', 1, 2, true),
  ('arkansas', 8, 'South', 1, 1, true),
  ('baylor', 3, 'East', 1, 2, true),
  ('bucknell', 13, 'West', 1, 0, true),
  ('butler', 4, 'South', 1, 2, true),
  ('cincinnati', 6, 'South', 1, 1, true),
  ('creighton', 6, 'Midwest', 1, 0, true),
  ('dayton', 7, 'South', 1, 0, true),
  ('duke', 2, 'East', 1, 1, true),
  ('east-tennessee-state', 13, 'East', 1, 0, true),
  ('florida', 4, 'East', 1, 3, true),
  ('florida-gulf-coast', 14, 'West', 1, 0, true),
  ('florida-state', 3, 'West', 1, 1, true),
  ('gonzaga', 1, 'West', 1, 5, true),
  ('iona', 14, 'Midwest', 1, 0, true),
  ('iowa-state', 5, 'Midwest', 1, 1, true),
  ('jacksonville-state', 15, 'Midwest', 1, 0, true),
  ('kansas', 1, 'Midwest', 1, 3, true),
  ('kansas-state', 11, 'South', 0, 1, true),
  ('kent-state', 14, 'South', 1, 0, true),
  ('kentucky', 2, 'South', 1, 3, true),
  ('louisville', 2, 'Midwest', 1, 1, true),
  ('marquette', 10, 'East', 1, 0, true),
  ('maryland', 6, 'West', 1, 0, true),
  ('miami-fl', 8, 'Midwest', 1, 0, true),
  ('michigan', 7, 'Midwest', 1, 2, true),
  ('michigan-state', 9, 'Midwest', 1, 1, true),
  ('middle-tennessee', 12, 'South', 1, 1, true),
  ('minnesota', 5, 'South', 1, 0, true),
  ('mount-st-mary-s', 16, 'East', 0, 1, true),
  ('nevada', 12, 'Midwest', 1, 0, true),
  ('new-mexico-state', 14, 'East', 1, 0, true),
  ('new-orleans', 16, 'East', 0, 0, true),
  ('north-carolina', 1, 'South', 1, 6, false),
  ('north-carolina-central', 16, 'Midwest', 0, 0, true),
  ('north-dakota', 15, 'West', 1, 0, true),
  ('northern-kentucky', 15, 'South', 1, 0, true),
  ('northwestern', 8, 'West', 1, 1, true),
  ('notre-dame', 5, 'West', 1, 1, true),
  ('oklahoma-state', 10, 'Midwest', 1, 0, true),
  ('oregon', 3, 'Midwest', 1, 4, true),
  ('princeton', 12, 'West', 1, 0, true),
  ('providence', 11, 'East', 0, 0, true),
  ('purdue', 4, 'Midwest', 1, 2, true),
  ('rhode-island', 11, 'Midwest', 1, 1, true),
  ('saint-mary-s-ca', 7, 'West', 1, 1, true),
  ('seton-hall', 9, 'South', 1, 0, true),
  ('south-carolina', 7, 'East', 1, 4, true),
  ('south-dakota-state', 16, 'West', 1, 0, true),
  ('southern-california', 11, 'East', 0, 2, true),
  ('southern-methodist', 6, 'East', 1, 0, true),
  ('texas-southern', 16, 'South', 1, 0, true),
  ('troy', 15, 'East', 1, 0, true),
  ('uc-davis', 16, 'Midwest', 0, 1, true),
  ('ucla', 3, 'South', 1, 2, true),
  ('unc-wilmington', 12, 'East', 1, 0, true),
  ('vanderbilt', 9, 'West', 1, 0, true),
  ('vermont', 13, 'Midwest', 1, 0, true),
  ('villanova', 1, 'East', 1, 1, true),
  ('virginia', 5, 'East', 1, 1, true),
  ('virginia-commonwealth', 10, 'West', 1, 0, true),
  ('virginia-tech', 9, 'East', 1, 0, true),
  ('wake-forest', 11, 'South', 0, 0, true),
  ('west-virginia', 4, 'West', 1, 2, true),
  ('wichita-state', 10, 'South', 1, 1, true),
  ('winthrop', 13, 'South', 1, 0, true),
  ('wisconsin', 8, 'East', 1, 2, true),
  ('xavier', 11, 'West', 1, 3, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2017' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('arizona', 22.74, 117.6, 94.9, 65.6),
  ('arkansas', 15.6, 116.6, 101, 69.3),
  ('baylor', 25.01, 117.3, 92.3, 63),
  ('bucknell', 8.72, 109.1, 100.4, 69.6),
  ('butler', 20.91, 118, 97.1, 65.2),
  ('cincinnati', 22.32, 114.2, 91.9, 63.7),
  ('creighton', 19.59, 115.6, 96.1, 70.8),
  ('dayton', 15.67, 112.3, 96.6, 68.5),
  ('duke', 25.09, 121, 95.9, 67.9),
  ('east-tennessee-state', 11.48, 108, 96.5, 69.9),
  ('florida', 26.39, 115.9, 89.5, 68.7),
  ('florida-gulf-coast', 5.02, 109.6, 104.6, 65.2),
  ('florida-state', 22.74, 116.7, 94, 70.7),
  ('gonzaga', 33.05, 120.7, 87.7, 69.9),
  ('iona', 4, 110.2, 106.2, 70.4),
  ('iowa-state', 23.11, 119.6, 96.4, 68.1),
  ('jacksonville-state', 0.58, 105.4, 104.8, 63.5),
  ('kansas', 25.98, 120.8, 94.9, 70.2),
  ('kansas-state', 17.55, 112, 94.5, 66.1),
  ('kent-state', 1.73, 104.4, 102.7, 68.2),
  ('kentucky', 27.27, 119.1, 91.9, 72.7),
  ('louisville', 26.72, 117.2, 90.5, 67.9),
  ('marquette', 17.57, 121, 103.4, 69.9),
  ('maryland', 14.84, 113.6, 98.7, 67),
  ('miami-fl', 16.96, 110.4, 93.4, 62.9),
  ('michigan', 22.62, 121.6, 99, 62.8),
  ('michigan-state', 14.98, 110.6, 95.6, 66.6),
  ('middle-tennessee', 14.66, 111.7, 97, 64.2),
  ('minnesota', 16.59, 109.6, 93, 69.3),
  ('mount-st-mary-s', -4.23, 99, 103.2, 66.7),
  ('nevada', 13.34, 114.5, 101.1, 69.6),
  ('new-mexico-state', 7.31, 110.1, 102.7, 67.4),
  ('new-orleans', -0.52, 100.9, 101.4, 66.1),
  ('north-carolina', 28.01, 122.1, 94.1, 70.6),
  ('north-carolina-central', 0.96, 102.8, 101.8, 66.3),
  ('north-dakota', -0.31, 102.9, 103.2, 71.2),
  ('northern-kentucky', 1.34, 106.6, 105.3, 67.7),
  ('northwestern', 15.51, 111.2, 95.7, 65),
  ('notre-dame', 21.09, 118.9, 97.8, 67),
  ('oklahoma-state', 22.1, 124.8, 102.7, 70.2),
  ('oregon', 23.83, 117.7, 93.9, 66.6),
  ('princeton', 12.5, 109.4, 96.9, 63.1),
  ('providence', 12.9, 108, 95.1, 66.3),
  ('purdue', 24.22, 116.9, 92.7, 68.8),
  ('rhode-island', 15.62, 110.7, 95.1, 66),
  ('saint-mary-s-ca', 24.64, 118.9, 94.3, 59.2),
  ('seton-hall', 13.95, 109.8, 95.9, 67.2),
  ('south-carolina', 17.03, 105.6, 88.5, 68.1),
  ('south-dakota-state', -1.33, 110.8, 112.1, 67),
  ('southern-california', 12.34, 112.5, 100.2, 68.8),
  ('southern-methodist', 25.26, 120.1, 94.8, 63.5),
  ('texas-southern', -3.66, 103.6, 107.3, 68.4),
  ('troy', 2.68, 109.9, 107.2, 68),
  ('uc-davis', -4.75, 97.9, 102.6, 68.4),
  ('ucla', 22.95, 122.8, 99.8, 73.1),
  ('unc-wilmington', 12.39, 117.7, 105.3, 70),
  ('vanderbilt', 16.24, 112.3, 96.1, 65.5),
  ('vermont', 11.88, 110.8, 99, 64.3),
  ('villanova', 30.78, 122.8, 92, 63.9),
  ('virginia', 26.67, 113.7, 87, 58.8),
  ('virginia-commonwealth', 14.3, 110, 95.7, 68.1),
  ('virginia-tech', 14.94, 117.4, 102.4, 68.2),
  ('wake-forest', 17.27, 120.9, 103.6, 70.4),
  ('west-virginia', 26.8, 116.5, 89.7, 69.8),
  ('wichita-state', 26.41, 119.6, 93.2, 68.5),
  ('winthrop', 4.63, 106.4, 101.8, 70.9),
  ('wisconsin', 22.29, 113.6, 91.3, 63.2),
  ('xavier', 15.32, 114.8, 99.4, 67.1)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2017' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
