SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2022)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2022', 7, '2022-03-17T11:15:00-05:00',
  NULLIF('West', ''), NULLIF('East', ''), NULLIF('South', ''), NULLIF('Midwest', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2022
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('akron', 13, 'East', 1, 0, true),
  ('alabama', 6, 'West', 1, 0, true),
  ('arizona', 1, 'South', 1, 2, true),
  ('arkansas', 4, 'West', 1, 3, true),
  ('auburn', 2, 'Midwest', 1, 1, true),
  ('baylor', 1, 'East', 1, 1, true),
  ('boise-state', 8, 'West', 1, 0, true),
  ('bryant', 16, 'South', 0, 0, true),
  ('cal-state-fullerton', 15, 'West', 1, 0, true),
  ('chattanooga', 13, 'South', 1, 0, true),
  ('colgate', 14, 'Midwest', 1, 0, true),
  ('colorado-state', 6, 'South', 1, 0, true),
  ('connecticut', 5, 'West', 1, 0, true),
  ('creighton', 9, 'Midwest', 1, 1, true),
  ('davidson', 10, 'West', 1, 0, true),
  ('delaware', 15, 'South', 1, 0, true),
  ('duke', 2, 'West', 1, 4, true),
  ('georgia-state', 16, 'West', 1, 0, true),
  ('gonzaga', 1, 'West', 1, 2, true),
  ('houston', 5, 'South', 1, 3, true),
  ('illinois', 4, 'South', 1, 1, true),
  ('indiana', 12, 'East', 0, 1, true),
  ('iowa', 5, 'Midwest', 1, 0, true),
  ('iowa-state', 11, 'Midwest', 1, 2, true),
  ('jacksonville-state', 15, 'Midwest', 1, 0, true),
  ('kansas', 1, 'Midwest', 1, 6, false),
  ('kentucky', 2, 'East', 1, 0, true),
  ('longwood', 14, 'South', 1, 0, true),
  ('louisiana-state', 6, 'Midwest', 1, 0, true),
  ('loyola-il', 10, 'South', 1, 0, true),
  ('marquette', 9, 'East', 1, 0, true),
  ('memphis', 9, 'West', 1, 1, true),
  ('miami-fl', 10, 'Midwest', 1, 3, true),
  ('michigan', 11, 'South', 1, 2, true),
  ('michigan-state', 7, 'West', 1, 1, true),
  ('montana-state', 14, 'West', 1, 0, true),
  ('murray-state', 7, 'East', 1, 1, true),
  ('new-mexico-state', 12, 'West', 1, 1, true),
  ('norfolk-state', 16, 'East', 1, 0, true),
  ('north-carolina', 8, 'East', 1, 5, true),
  ('notre-dame', 11, 'West', 0, 2, true),
  ('ohio-state', 7, 'South', 1, 1, true),
  ('providence', 4, 'Midwest', 1, 2, true),
  ('purdue', 3, 'East', 1, 2, true),
  ('richmond', 12, 'Midwest', 1, 1, true),
  ('rutgers', 11, 'West', 0, 0, true),
  ('saint-mary-s-ca', 5, 'East', 1, 1, true),
  ('saint-peter-s', 15, 'East', 1, 3, true),
  ('san-diego-state', 8, 'Midwest', 1, 0, true),
  ('san-francisco', 10, 'East', 1, 0, true),
  ('seton-hall', 8, 'South', 1, 0, true),
  ('south-dakota-state', 13, 'Midwest', 1, 0, true),
  ('southern-california', 7, 'Midwest', 1, 0, true),
  ('tcu', 9, 'South', 1, 1, true),
  ('tennessee', 3, 'South', 1, 1, true),
  ('texas', 6, 'East', 1, 1, true),
  ('texas-a-m-corpus-christi', 16, 'Midwest', 0, 0, true),
  ('texas-southern', 16, 'Midwest', 0, 1, true),
  ('texas-tech', 3, 'West', 1, 2, true),
  ('uab', 12, 'South', 1, 0, true),
  ('ucla', 4, 'East', 1, 2, true),
  ('vermont', 13, 'West', 1, 0, true),
  ('villanova', 2, 'South', 1, 4, true),
  ('virginia-tech', 11, 'East', 1, 0, true),
  ('wisconsin', 3, 'Midwest', 1, 1, true),
  ('wright-state', 16, 'South', 0, 1, true),
  ('wyoming', 12, 'East', 0, 0, true),
  ('yale', 14, 'East', 1, 0, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2022' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('akron', 3.49, 106.2, 102.7, 62.1),
  ('alabama', 17.36, 116.1, 98.7, 71.7),
  ('arizona', 27.21, 119.6, 92.4, 72.2),
  ('arkansas', 19.02, 111.1, 92.1, 70.6),
  ('auburn', 24.45, 113.6, 89.1, 70),
  ('baylor', 26.32, 117.9, 91.6, 67.2),
  ('boise-state', 16.41, 108.4, 92, 64.6),
  ('bryant', -0.95, 104.2, 105.2, 72.2),
  ('cal-state-fullerton', 2.1, 104.7, 102.6, 66),
  ('chattanooga', 11.27, 110, 98.8, 64.6),
  ('colgate', 4.22, 108.3, 104.1, 67.3),
  ('colorado-state', 15.86, 114.2, 98.3, 65.1),
  ('connecticut', 19.33, 113.9, 94.6, 64.9),
  ('creighton', 13.47, 105.6, 92.1, 66.9),
  ('davidson', 14.8, 116.8, 102, 64.6),
  ('delaware', 2.28, 106.8, 104.6, 66.6),
  ('duke', 23.71, 119.4, 95.7, 67.4),
  ('georgia-state', 1.84, 101.5, 99.7, 67.1),
  ('gonzaga', 32.97, 121.8, 88.8, 72.5),
  ('houston', 26.5, 117.3, 90.9, 63.8),
  ('illinois', 19.59, 113.7, 94.1, 67.1),
  ('indiana', 14.94, 107.6, 92.6, 67),
  ('iowa', 23.53, 121.5, 98, 69.6),
  ('iowa-state', 13.95, 104.4, 90.4, 66.1),
  ('jacksonville-state', 2.24, 105.3, 103.1, 65.1),
  ('kansas', 25.49, 119.4, 93.9, 69.1),
  ('kentucky', 26.59, 120.2, 93.6, 67.3),
  ('longwood', 2.48, 106.1, 103.6, 66),
  ('louisiana-state', 19.08, 107.6, 88.6, 68.6),
  ('loyola-il', 17.69, 110.9, 93.2, 64.6),
  ('marquette', 14, 109.8, 95.8, 70.7),
  ('memphis', 16.22, 110.4, 94.1, 70.3),
  ('miami-fl', 12.62, 114.8, 102.1, 67.3),
  ('michigan', 15.65, 114.2, 98.6, 66.3),
  ('michigan-state', 14.87, 111.3, 96.4, 67.5),
  ('montana-state', 3.81, 104.5, 100.7, 67.3),
  ('murray-state', 16.39, 111.5, 95.1, 65.8),
  ('new-mexico-state', 10.1, 107.8, 97.7, 66.2),
  ('norfolk-state', 0.15, 102.4, 102.3, 66.9),
  ('north-carolina', 16.05, 113.1, 97, 70.1),
  ('notre-dame', 13.63, 112, 98.4, 65.7),
  ('ohio-state', 15.82, 116.6, 100.8, 65),
  ('providence', 13.88, 111.9, 98, 65.2),
  ('purdue', 22.29, 121.3, 99, 65.8),
  ('richmond', 9.83, 109.1, 99.3, 66.9),
  ('rutgers', 10.86, 106.4, 95.5, 64.9),
  ('saint-mary-s-ca', 19.81, 109.8, 90, 63.5),
  ('saint-peter-s', 4.28, 98.8, 94.5, 66),
  ('san-diego-state', 18.15, 104.1, 86, 65.3),
  ('san-francisco', 18.37, 110.8, 92.4, 68.7),
  ('seton-hall', 14.97, 108.5, 93.5, 67.3),
  ('south-dakota-state', 11.44, 116.8, 105.3, 69.4),
  ('southern-california', 14.45, 110.5, 96, 66),
  ('tcu', 14.91, 108.3, 93.4, 65.8),
  ('tennessee', 25.24, 111.4, 86.2, 67.2),
  ('texas', 20.41, 111.8, 91.4, 63.1),
  ('texas-a-m-corpus-christi', -6.31, 97, 103.3, 68.9),
  ('texas-southern', -1.33, 98.1, 99.5, 67.6),
  ('texas-tech', 24.64, 109.7, 85.1, 66.5),
  ('uab', 14.03, 112.5, 98.5, 68.8),
  ('ucla', 24.85, 116.1, 91.2, 65.5),
  ('vermont', 13.07, 110.8, 97.7, 65),
  ('villanova', 24.11, 118, 93.8, 62.5),
  ('virginia-tech', 17.86, 114.3, 96.4, 62.9),
  ('wisconsin', 15.58, 110.4, 94.8, 66.5),
  ('wright-state', -0.87, 106.4, 107.2, 68.4),
  ('wyoming', 13.1, 110.2, 97.1, 66),
  ('yale', 2.23, 101.5, 99.2, 68.7)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2022' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
