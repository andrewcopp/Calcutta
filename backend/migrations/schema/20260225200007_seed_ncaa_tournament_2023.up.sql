SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2023)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2023', 7, '2023-03-16T11:15:00-05:00',
  NULLIF('South', ''), NULLIF('East', ''), NULLIF('Midwest', ''), NULLIF('West', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2023
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('alabama', 1, 'South', 1, 2, true),
  ('arizona', 2, 'South', 1, 0, true),
  ('arizona-state', 11, 'West', 0, 1, true),
  ('arkansas', 8, 'West', 1, 2, true),
  ('auburn', 9, 'Midwest', 1, 1, true),
  ('baylor', 3, 'South', 1, 1, true),
  ('boise-state', 10, 'West', 1, 0, true),
  ('colgate', 15, 'Midwest', 1, 0, true),
  ('college-of-charleston', 12, 'South', 1, 0, true),
  ('connecticut', 4, 'West', 1, 6, false),
  ('creighton', 6, 'South', 1, 3, true),
  ('drake', 12, 'Midwest', 1, 0, true),
  ('duke', 5, 'East', 1, 1, true),
  ('fdu', 16, 'East', 0, 2, true),
  ('florida-atlantic', 9, 'East', 1, 4, true),
  ('furman', 13, 'South', 1, 1, true),
  ('gonzaga', 3, 'West', 1, 3, true),
  ('grand-canyon', 14, 'West', 1, 0, true),
  ('houston', 1, 'Midwest', 1, 2, true),
  ('howard', 16, 'West', 1, 0, true),
  ('illinois', 9, 'West', 1, 0, true),
  ('indiana', 4, 'Midwest', 1, 1, true),
  ('iona', 13, 'West', 1, 0, true),
  ('iowa', 8, 'Midwest', 1, 0, true),
  ('iowa-state', 6, 'Midwest', 1, 0, true),
  ('kansas', 1, 'West', 1, 1, true),
  ('kansas-state', 3, 'East', 1, 3, true),
  ('kennesaw-state', 14, 'Midwest', 1, 0, true),
  ('kent-state', 13, 'Midwest', 1, 0, true),
  ('kentucky', 6, 'East', 1, 1, true),
  ('louisiana', 13, 'East', 1, 0, true),
  ('marquette', 2, 'East', 1, 1, true),
  ('maryland', 8, 'South', 1, 1, true),
  ('memphis', 8, 'East', 1, 0, true),
  ('miami-fl', 5, 'Midwest', 1, 4, true),
  ('michigan-state', 7, 'East', 1, 2, true),
  ('mississippi-state', 11, 'Midwest', 0, 0, true),
  ('missouri', 7, 'South', 1, 1, true),
  ('montana-state', 14, 'East', 1, 0, true),
  ('nc-state', 11, 'South', 1, 0, true),
  ('nevada', 11, 'West', 0, 0, true),
  ('northern-kentucky', 16, 'Midwest', 1, 0, true),
  ('northwestern', 7, 'West', 1, 1, true),
  ('oral-roberts', 12, 'East', 1, 0, true),
  ('penn-state', 10, 'Midwest', 1, 1, true),
  ('pittsburgh', 11, 'Midwest', 0, 2, true),
  ('princeton', 15, 'South', 1, 2, true),
  ('providence', 11, 'East', 1, 0, true),
  ('purdue', 1, 'East', 1, 0, true),
  ('saint-mary-s-ca', 5, 'West', 1, 1, true),
  ('san-diego-state', 5, 'South', 1, 5, true),
  ('southeast-missouri-state', 16, 'South', 0, 1, true),
  ('southern-california', 10, 'East', 1, 0, true),
  ('tcu', 6, 'West', 1, 1, true),
  ('tennessee', 4, 'East', 1, 2, true),
  ('texas', 2, 'Midwest', 1, 3, true),
  ('texas-a-m', 7, 'Midwest', 1, 0, true),
  ('texas-a-m-corpus-christi', 16, 'South', 0, 0, true),
  ('texas-southern', 16, 'East', 0, 0, true),
  ('uc-santa-barbara', 14, 'South', 1, 0, true),
  ('ucla', 2, 'West', 1, 2, true),
  ('unc-asheville', 15, 'West', 1, 0, true),
  ('utah-state', 10, 'South', 1, 0, true),
  ('vermont', 15, 'East', 1, 0, true),
  ('virginia', 4, 'South', 1, 0, true),
  ('virginia-commonwealth', 12, 'West', 1, 0, true),
  ('west-virginia', 9, 'South', 1, 0, true),
  ('xavier', 3, 'Midwest', 1, 2, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2023' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('alabama', 27.54, 116.1, 88.6, 72.7),
  ('arizona', 22.86, 120, 97.1, 72.3),
  ('arizona-state', 12.38, 107.6, 95.2, 68.4),
  ('arkansas', 18.63, 112.6, 94, 69.7),
  ('auburn', 17.45, 112.7, 95.2, 67.6),
  ('baylor', 19.98, 121.9, 101.9, 66.6),
  ('boise-state', 17.13, 111, 93.8, 66.5),
  ('colgate', 5.29, 113, 107.7, 67.9),
  ('college-of-charleston', 11.76, 111.4, 99.6, 71),
  ('connecticut', 25.37, 119.4, 94.1, 66.7),
  ('creighton', 20.65, 114.6, 94, 68),
  ('drake', 12.51, 109.8, 97.3, 66.4),
  ('duke', 18.49, 113.2, 94.8, 65.3),
  ('fdu', -12.25, 106.2, 118.4, 68.8),
  ('florida-atlantic', 18.23, 114.3, 96, 68.4),
  ('furman', 8.43, 114.2, 105.8, 68.5),
  ('gonzaga', 24.31, 124, 99.7, 70.1),
  ('grand-canyon', 5.99, 112.3, 106.3, 65.2),
  ('houston', 28.82, 118.4, 89.6, 63.3),
  ('howard', -3.21, 103.7, 106.9, 69),
  ('illinois', 16.48, 112.2, 95.7, 69.4),
  ('indiana', 17.36, 114.7, 97.3, 68.1),
  ('iona', 11.71, 110.9, 99.1, 68.9),
  ('iowa', 15.6, 120.5, 104.9, 69.5),
  ('iowa-state', 18.33, 109.9, 91.5, 64.3),
  ('kansas', 23.14, 114.6, 91.5, 69.3),
  ('kansas-state', 18.31, 112.5, 94.2, 70.2),
  ('kennesaw-state', 3.64, 106.3, 102.7, 68.5),
  ('kent-state', 11.9, 108.3, 96.4, 68.1),
  ('kentucky', 17.8, 117.4, 99.6, 66),
  ('louisiana', 8.2, 112.2, 104, 68.4),
  ('marquette', 21.83, 119.3, 97.5, 68.4),
  ('maryland', 18.37, 114.1, 95.8, 64.6),
  ('memphis', 18.69, 114.7, 96, 71.8),
  ('miami-fl', 14.91, 118.2, 103.3, 68.9),
  ('michigan-state', 16.71, 113.4, 96.7, 64.9),
  ('mississippi-state', 14.12, 105.5, 91.3, 63.8),
  ('missouri', 13.92, 119.3, 105.4, 69.1),
  ('montana-state', 5.75, 105.4, 99.6, 66.5),
  ('nc-state', 13.31, 113.9, 100.6, 69.1),
  ('nevada', 14.79, 112, 97.2, 66.1),
  ('northern-kentucky', 0.52, 103.3, 102.8, 62),
  ('northwestern', 14.83, 108.5, 93.7, 64.9),
  ('oral-roberts', 13.25, 115.3, 102, 70.5),
  ('penn-state', 15.04, 116.8, 101.8, 64.6),
  ('pittsburgh', 11.27, 115.1, 103.8, 67.3),
  ('princeton', 5.57, 109.1, 103.5, 67.5),
  ('providence', 14.73, 116.8, 102.1, 66.9),
  ('purdue', 24.55, 119.4, 94.8, 64.4),
  ('saint-mary-s-ca', 21.9, 113.5, 91.6, 61.7),
  ('san-diego-state', 20.25, 111.9, 91.7, 66),
  ('southeast-missouri-state', -7.21, 100.9, 108.1, 72.5),
  ('southern-california', 15.63, 113.1, 97.5, 68.1),
  ('tcu', 18.06, 112.4, 94.3, 69.8),
  ('tennessee', 24.71, 112.7, 88, 65.5),
  ('texas', 24.57, 116.6, 92, 69.1),
  ('texas-a-m', 18.28, 114.5, 96.2, 66.2),
  ('texas-a-m-corpus-christi', -0.23, 107.4, 107.6, 69.3),
  ('texas-southern', -9.71, 96.6, 106.3, 69.3),
  ('uc-santa-barbara', 6.64, 111.3, 104.7, 65),
  ('ucla', 27.63, 114.9, 87.2, 66.3),
  ('unc-asheville', 1.51, 104.1, 102.6, 68.5),
  ('utah-state', 18.88, 117.8, 98.9, 68.8),
  ('vermont', 5.42, 109.8, 104.4, 64.6),
  ('virginia', 16.41, 111.2, 94.8, 61.6),
  ('virginia-commonwealth', 13.15, 107.2, 94, 68),
  ('west-virginia', 19.14, 117.1, 98, 68.9),
  ('xavier', 19.69, 119.3, 99.6, 70.4)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2023' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
