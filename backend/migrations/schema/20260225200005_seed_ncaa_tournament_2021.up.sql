SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2021)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2021', 7, '2021-03-19T11:15:00-05:00',
  NULLIF('West', ''), NULLIF('East', ''), NULLIF('South', ''), NULLIF('Midwest', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2021
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('abilene-christian', 14, 'East', 1, 1, true),
  ('alabama', 2, 'East', 1, 2, true),
  ('appalachian-state', 16, 'West', 0, 0, true),
  ('arkansas', 3, 'South', 1, 3, true),
  ('baylor', 1, 'South', 1, 6, false),
  ('brigham-young', 6, 'East', 1, 0, true),
  ('clemson', 7, 'Midwest', 1, 0, true),
  ('cleveland-state', 15, 'Midwest', 1, 0, true),
  ('colgate', 14, 'South', 1, 0, true),
  ('colorado', 5, 'East', 1, 1, true),
  ('connecticut', 7, 'East', 1, 0, true),
  ('creighton', 5, 'West', 1, 2, true),
  ('drake', 11, 'West', 0, 1, true),
  ('drexel', 16, 'Midwest', 1, 0, true),
  ('eastern-washington', 14, 'West', 1, 0, true),
  ('florida', 7, 'South', 1, 1, true),
  ('florida-state', 4, 'East', 1, 2, true),
  ('georgetown', 12, 'East', 1, 0, true),
  ('georgia-tech', 9, 'Midwest', 1, 0, true),
  ('gonzaga', 1, 'West', 1, 5, true),
  ('grand-canyon', 15, 'West', 1, 0, true),
  ('hartford-hawks', 16, 'South', 1, 0, true),
  ('houston', 2, 'Midwest', 1, 4, true),
  ('illinois', 1, 'Midwest', 1, 1, true),
  ('iona', 15, 'East', 1, 0, true),
  ('iowa', 2, 'West', 1, 1, true),
  ('kansas', 3, 'West', 1, 1, true),
  ('liberty', 13, 'Midwest', 1, 0, true),
  ('louisiana-state', 8, 'East', 1, 1, true),
  ('loyola-il', 8, 'Midwest', 1, 2, true),
  ('maryland', 10, 'East', 1, 1, true),
  ('michigan', 1, 'East', 1, 3, true),
  ('michigan-state', 11, 'East', 0, 0, true),
  ('missouri', 9, 'West', 1, 0, true),
  ('morehead-state', 14, 'Midwest', 1, 0, true),
  ('mount-st-mary-s', 16, 'East', 0, 0, true),
  ('norfolk-state', 16, 'West', 0, 1, true),
  ('north-carolina', 8, 'South', 1, 0, true),
  ('north-texas', 13, 'South', 1, 1, true),
  ('ohio', 13, 'West', 1, 1, true),
  ('ohio-state', 2, 'South', 1, 0, true),
  ('oklahoma', 8, 'West', 1, 1, true),
  ('oklahoma-state', 4, 'Midwest', 1, 1, true),
  ('oral-roberts', 15, 'South', 1, 2, true),
  ('oregon', 7, 'West', 1, 2, true),
  ('oregon-state', 12, 'Midwest', 1, 3, true),
  ('purdue', 4, 'South', 1, 0, true),
  ('rutgers', 10, 'Midwest', 1, 1, true),
  ('san-diego-state', 6, 'Midwest', 1, 0, true),
  ('southern-california', 6, 'West', 1, 3, true),
  ('st-bonaventure', 9, 'East', 1, 0, true),
  ('syracuse', 11, 'Midwest', 1, 2, true),
  ('tennessee', 5, 'Midwest', 1, 0, true),
  ('texas', 3, 'East', 1, 0, true),
  ('texas-southern', 16, 'East', 0, 1, true),
  ('texas-tech', 6, 'South', 1, 1, true),
  ('uc-santa-barbara', 12, 'West', 1, 0, true),
  ('ucla', 11, 'East', 0, 5, true),
  ('unc-greensboro', 13, 'East', 1, 0, true),
  ('utah-state', 11, 'South', 1, 0, true),
  ('villanova', 5, 'South', 1, 2, true),
  ('virginia', 4, 'West', 1, 0, true),
  ('virginia-commonwealth', 10, 'West', 1, 0, true),
  ('virginia-tech', 10, 'South', 1, 0, true),
  ('west-virginia', 3, 'Midwest', 1, 1, true),
  ('wichita-state', 11, 'West', 0, 0, true),
  ('winthrop', 12, 'South', 1, 0, true),
  ('wisconsin', 9, 'South', 1, 1, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2021' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('abilene-christian', 10.13, 103, 92.9, 70),
  ('alabama', 24.99, 111.7, 86.7, 73.9),
  ('appalachian-state', -4.34, 99.4, 103.7, 65.7),
  ('arkansas', 21.53, 111.5, 90, 73.1),
  ('baylor', 29.5, 123.3, 93.8, 68.4),
  ('brigham-young', 20.95, 113.1, 92.2, 68),
  ('clemson', 16.17, 106.9, 90.7, 64.2),
  ('cleveland-state', 1.37, 100.9, 99.5, 66.3),
  ('colgate', 10.22, 110.9, 100.7, 72.4),
  ('colorado', 21.68, 114.4, 92.7, 66.4),
  ('connecticut', 21.9, 113.6, 91.7, 66),
  ('creighton', 21.31, 114.9, 93.6, 69.1),
  ('drake', 14.64, 113.9, 99.3, 66.8),
  ('drexel', 1.62, 107.1, 105.5, 64.2),
  ('eastern-washington', 6.65, 107.7, 101, 72.3),
  ('florida', 17.55, 111, 93.4, 68.6),
  ('florida-state', 22.07, 116.4, 94.4, 70.6),
  ('georgetown', 14.06, 107.7, 93.6, 69.6),
  ('georgia-tech', 18.55, 113.3, 94.8, 67.8),
  ('gonzaga', 36.62, 126.1, 89.5, 74.8),
  ('grand-canyon', 6.98, 103.6, 96.6, 65.5),
  ('hartford-hawks', -2.73, 97.5, 100.2, 66.7),
  ('houston', 28.82, 118.9, 90.1, 64.9),
  ('illinois', 30.61, 119, 88.3, 70.7),
  ('iona', -1.04, 100.4, 101.4, 68.3),
  ('iowa', 28.9, 123.5, 94.6, 70),
  ('kansas', 21.03, 109.6, 88.6, 68.3),
  ('liberty', 8.37, 110.1, 101.8, 63.1),
  ('louisiana-state', 19.59, 119.8, 100.2, 70.8),
  ('loyola-il', 23.75, 110.4, 86.7, 64.2),
  ('maryland', 18.72, 110.9, 92.2, 65.3),
  ('michigan', 30.79, 119.4, 88.6, 66.8),
  ('michigan-state', 14.01, 107, 93, 68.6),
  ('missouri', 15.15, 110.2, 95.1, 68.7),
  ('morehead-state', 3.9, 100.2, 96.3, 65.6),
  ('mount-st-mary-s', -5.01, 95.4, 100.4, 62.2),
  ('norfolk-state', -3.74, 100.6, 104.4, 67.7),
  ('north-carolina', 20.09, 110.1, 90, 71.8),
  ('north-texas', 11.7, 105.4, 93.7, 63.1),
  ('ohio', 11.11, 113, 101.9, 69.3),
  ('ohio-state', 25.43, 122.3, 96.8, 67.1),
  ('oklahoma', 16.64, 111.4, 94.8, 67.7),
  ('oklahoma-state', 18.77, 110.1, 91.3, 72),
  ('oral-roberts', 1.22, 108.7, 107.4, 71.8),
  ('oregon', 17.68, 114.5, 96.8, 67.2),
  ('oregon-state', 10.17, 109.3, 99.2, 65.4),
  ('purdue', 22.27, 113.6, 91.3, 66.5),
  ('rutgers', 18.14, 108.7, 90.5, 67.8),
  ('san-diego-state', 21.3, 110.8, 89.5, 66.1),
  ('southern-california', 22.22, 112.9, 90.7, 67.3),
  ('st-bonaventure', 20.82, 111.3, 90.5, 65.2),
  ('syracuse', 16.23, 113.8, 97.6, 69.2),
  ('tennessee', 21.06, 108.8, 87.7, 67.3),
  ('texas', 20.58, 113.8, 93.3, 69.2),
  ('texas-southern', -6.05, 99, 105, 72),
  ('texas-tech', 20.95, 112.4, 91.4, 65.4),
  ('uc-santa-barbara', 12.23, 109.2, 97, 66.1),
  ('ucla', 15.92, 113.4, 97.5, 64.7),
  ('unc-greensboro', 8.15, 104.1, 96, 68.5),
  ('utah-state', 16.51, 105.7, 89.2, 68.9),
  ('villanova', 22.62, 118.6, 96, 65.1),
  ('virginia', 22.65, 115.6, 93, 60.1),
  ('virginia-commonwealth', 15.91, 105.5, 89.6, 69.8),
  ('virginia-tech', 15.22, 110, 94.8, 66.2),
  ('west-virginia', 20.32, 116.1, 95.8, 69.6),
  ('wichita-state', 11.55, 110, 98.4, 67.6),
  ('winthrop', 8.94, 105.1, 96.2, 73.6),
  ('wisconsin', 22.65, 112.5, 89.9, 64.9)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2021' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
