SET search_path = '';

INSERT INTO core.seasons (year) VALUES (2018)
ON CONFLICT (year) DO NOTHING;

INSERT INTO core.tournaments (competition_id, season_id, import_key, rounds, starting_at,
  final_four_top_left, final_four_bottom_left, final_four_top_right, final_four_bottom_right)
SELECT c.id, s.id, 'ncaa-tournament-2018', 7, '2018-03-15T11:40:00-05:00',
  NULLIF('South', ''), NULLIF('West', ''), NULLIF('East', ''), NULLIF('Midwest', '')
FROM core.competitions c, core.seasons s
WHERE c.name = 'NCAA Tournament' AND s.year = 2018
ON CONFLICT (import_key) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.teams (tournament_id, school_id, seed, region, byes, wins, is_eliminated)
SELECT t.id, s.id, v.seed, v.region, v.byes, v.wins, v.is_eliminated
FROM (VALUES
  ('alabama', 9, 'East', 1, 1, true),
  ('arizona', 4, 'South', 1, 0, true),
  ('arizona-state', 11, 'Midwest', 0, 0, true),
  ('arkansas', 7, 'East', 1, 0, true),
  ('auburn', 4, 'Midwest', 1, 1, true),
  ('bucknell', 14, 'Midwest', 1, 0, true),
  ('buffalo', 13, 'South', 1, 1, true),
  ('butler', 10, 'East', 1, 1, true),
  ('cal-state-fullerton', 15, 'East', 1, 0, true),
  ('cincinnati', 2, 'South', 1, 1, true),
  ('clemson', 5, 'Midwest', 1, 2, true),
  ('college-of-charleston', 13, 'Midwest', 1, 0, true),
  ('creighton', 8, 'South', 1, 0, true),
  ('davidson', 12, 'South', 1, 0, true),
  ('duke', 2, 'Midwest', 1, 3, true),
  ('florida', 6, 'East', 1, 1, true),
  ('florida-state', 9, 'West', 1, 3, true),
  ('georgia-state', 15, 'South', 1, 0, true),
  ('gonzaga', 4, 'West', 1, 2, true),
  ('houston', 6, 'West', 1, 1, true),
  ('iona', 15, 'Midwest', 1, 0, true),
  ('kansas', 1, 'Midwest', 1, 4, true),
  ('kansas-state', 9, 'South', 1, 3, true),
  ('kentucky', 5, 'South', 1, 2, true),
  ('lipscomb', 15, 'West', 1, 0, true),
  ('long-island-university', 16, 'East', 0, 0, true),
  ('loyola-il', 11, 'South', 1, 4, true),
  ('marshall', 13, 'East', 1, 1, true),
  ('maryland-baltimore-county', 16, 'South', 1, 1, true),
  ('miami-fl', 6, 'South', 1, 0, true),
  ('michigan', 3, 'West', 1, 5, true),
  ('michigan-state', 3, 'Midwest', 1, 1, true),
  ('missouri', 8, 'West', 1, 0, true),
  ('montana', 14, 'West', 1, 0, true),
  ('murray-state', 12, 'East', 1, 0, true),
  ('nc-state', 9, 'Midwest', 1, 0, true),
  ('nevada', 7, 'South', 1, 2, true),
  ('new-mexico-state', 12, 'Midwest', 1, 0, true),
  ('north-carolina', 2, 'West', 1, 1, true),
  ('north-carolina-central', 16, 'West', 0, 0, true),
  ('ohio-state', 5, 'West', 1, 1, true),
  ('oklahoma', 10, 'Midwest', 1, 0, true),
  ('pennsylvania', 16, 'Midwest', 1, 0, true),
  ('providence', 10, 'West', 1, 0, true),
  ('purdue', 2, 'East', 1, 2, true),
  ('radford', 16, 'East', 0, 1, true),
  ('rhode-island', 7, 'Midwest', 1, 1, true),
  ('san-diego-state', 11, 'West', 1, 0, true),
  ('seton-hall', 8, 'Midwest', 1, 1, true),
  ('south-dakota-state', 12, 'West', 1, 0, true),
  ('st-bonaventure', 11, 'East', 0, 1, true),
  ('stephen-f-austin', 14, 'East', 1, 0, true),
  ('syracuse', 11, 'Midwest', 0, 3, true),
  ('tcu', 6, 'Midwest', 1, 0, true),
  ('tennessee', 3, 'South', 1, 1, true),
  ('texas', 10, 'South', 1, 0, true),
  ('texas-a-m', 7, 'West', 1, 2, true),
  ('texas-southern', 16, 'West', 0, 1, true),
  ('texas-tech', 3, 'East', 1, 3, true),
  ('ucla', 11, 'East', 0, 0, true),
  ('unc-greensboro', 13, 'West', 1, 0, true),
  ('villanova', 1, 'East', 1, 6, false),
  ('virginia', 1, 'South', 1, 0, true),
  ('virginia-tech', 8, 'East', 1, 0, true),
  ('west-virginia', 5, 'East', 1, 2, true),
  ('wichita-state', 4, 'East', 1, 0, true),
  ('wright-state', 14, 'South', 1, 0, true),
  ('xavier', 1, 'West', 1, 1, true)
) AS v(school_slug, seed, region, byes, wins, is_eliminated)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2018' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
ON CONFLICT (tournament_id, school_id) WHERE deleted_at IS NULL DO NOTHING;

INSERT INTO core.team_kenpom_stats (team_id, net_rtg, o_rtg, d_rtg, adj_t)
SELECT tm.id, v.net_rtg, v.o_rtg, v.d_rtg, v.adj_t
FROM (VALUES
  ('alabama', 13.83, 108.4, 94.6, 68.7),
  ('arizona', 19.37, 119, 99.6, 67.3),
  ('arizona-state', 14.73, 117.6, 102.9, 71.5),
  ('arkansas', 15.63, 117.3, 101.7, 69.6),
  ('auburn', 20.63, 118.2, 97.5, 72.2),
  ('bucknell', 6.79, 109.2, 102.4, 71.4),
  ('buffalo', 10.57, 114.3, 103.7, 72.8),
  ('butler', 17.86, 115.7, 97.9, 67.8),
  ('cal-state-fullerton', 1.34, 105, 103.6, 69.5),
  ('cincinnati', 27, 113.1, 86.1, 64.6),
  ('clemson', 20.26, 113.8, 93.5, 65.6),
  ('college-of-charleston', 4.73, 109.9, 105.1, 64.6),
  ('creighton', 17.28, 116.4, 99.2, 70.8),
  ('davidson', 14.9, 117.4, 102.5, 64.1),
  ('duke', 29.12, 122.6, 93.5, 70),
  ('florida', 18.71, 115.1, 96.4, 66.7),
  ('florida-state', 15.82, 115.8, 100, 71.6),
  ('georgia-state', 7.22, 109, 101.8, 66.8),
  ('gonzaga', 24.81, 119.8, 95, 68.9),
  ('houston', 20.54, 115.8, 95.2, 68.2),
  ('iona', 2.86, 110.2, 107.4, 70.6),
  ('kansas', 23.24, 120.9, 97.7, 68.4),
  ('kansas-state', 14.75, 112.2, 97.4, 65.5),
  ('kentucky', 20.39, 116.4, 96, 68.5),
  ('lipscomb', 0.38, 103.8, 103.4, 74.8),
  ('long-island-university', -7.85, 103.3, 111.1, 71.3),
  ('loyola-il', 15.09, 111.3, 96.2, 65.3),
  ('marshall', 5.39, 109.3, 103.9, 74.8),
  ('maryland-baltimore-county', -1.99, 103.3, 105.3, 68.1),
  ('miami-fl', 15.7, 113.3, 97.6, 67),
  ('michigan', 23.19, 115.9, 92.7, 64.3),
  ('michigan-state', 26.34, 120, 93.6, 67.1),
  ('missouri', 15.47, 113.3, 97.8, 65.6),
  ('montana', 10.84, 110.1, 99.3, 67.9),
  ('murray-state', 12.69, 113.1, 100.4, 67.2),
  ('nc-state', 15.12, 116.4, 101.3, 71.3),
  ('nevada', 18.2, 119.9, 101.7, 69.4),
  ('new-mexico-state', 13.59, 108.4, 94.8, 68.2),
  ('north-carolina', 25.03, 121.9, 96.9, 70.9),
  ('north-carolina-central', -12.76, 98.1, 110.9, 64.9),
  ('ohio-state', 21.1, 116.1, 95, 66.3),
  ('oklahoma', 14.42, 115.1, 100.7, 75.8),
  ('pennsylvania', 3.69, 103.5, 99.8, 68.8),
  ('providence', 11.91, 108.9, 97, 67),
  ('purdue', 26.66, 123.2, 96.6, 67.2),
  ('radford', -0.02, 103.6, 103.6, 62.7),
  ('rhode-island', 14.38, 111.7, 97.3, 68.6),
  ('san-diego-state', 14.17, 111.3, 97.1, 68.6),
  ('seton-hall', 17.33, 116.3, 99, 69.3),
  ('south-dakota-state', 10.48, 114.5, 104, 70.2),
  ('st-bonaventure', 11.19, 112.3, 101.1, 69.2),
  ('stephen-f-austin', 5.62, 105, 99.4, 71.1),
  ('syracuse', 13.59, 107.7, 94.1, 63.3),
  ('tcu', 18.92, 120.6, 101.7, 68.7),
  ('tennessee', 22.15, 114.8, 92.7, 66.1),
  ('texas', 15.46, 109.4, 93.9, 65.2),
  ('texas-a-m', 16.91, 111.2, 94.3, 69),
  ('texas-southern', -7.64, 105.3, 112.9, 71.5),
  ('texas-tech', 21.95, 114, 92.1, 66.5),
  ('ucla', 14.39, 116.4, 102, 70.5),
  ('unc-greensboro', 9.06, 105.7, 96.6, 64.9),
  ('villanova', 31.4, 127.4, 96, 68.2),
  ('virginia', 32.15, 116.5, 84.4, 59.1),
  ('virginia-tech', 16.63, 115, 98.4, 68.6),
  ('west-virginia', 21.77, 119.1, 97.4, 69),
  ('wichita-state', 20.07, 121.9, 101.8, 68.6),
  ('wright-state', 2.81, 101, 98.2, 68.2),
  ('xavier', 21.68, 120.7, 99, 70.4)
) AS v(school_slug, net_rtg, o_rtg, d_rtg, adj_t)
JOIN core.tournaments t ON t.import_key = 'ncaa-tournament-2018' AND t.deleted_at IS NULL
JOIN core.schools s ON s.slug = v.school_slug AND s.deleted_at IS NULL
JOIN core.teams tm ON tm.tournament_id = t.id AND tm.school_id = s.id AND tm.deleted_at IS NULL
ON CONFLICT (team_id) DO NOTHING;
